{
  "spec_version": "0.1.0",
  "generated_at": "2026-02-15T15:00:00Z",
  "vectors": [
    {
      "name": "canonical-json-sorting",
      "description": "Verify canonical JSON key sorting per RFC 8785.",
      "input": {"z": 1, "a": 2, "m": 3},
      "expected_output": "{\"a\":2,\"m\":3,\"z\":1}",
      "notes": "Keys MUST be sorted lexicographically by Unicode code point. No whitespace."
    },
    {
      "name": "keccak256-empty-object",
      "description": "Keccak-256 hash of canonical empty JSON object.",
      "input": {},
      "expected_output": "0xb48d38f93eaa084033fc5970bf96e559c33c4cdc07d889ab00b4d63f9590739d",
      "notes": "Input canonical form is '{}'. Hash of UTF-8 bytes."
    },
    {
      "name": "keccak256-simple-passport",
      "description": "Keccak-256 of a minimal passport identity fragment.",
      "input": {"id": "did:key:z6MkpTHR8VNsBxYAAWHut2Geadd9jSwuBV8xRoAnwWsdvktH", "type": "AgentPassport"},
      "expected_output": "0x01023c707105c8d65952118e2268a934a3d6a8ee81bd42cfaa10d4c725cef31d",
      "notes": "Canonical: {\"id\":\"did:key:z6MkpTHR8VNsBxYAAWHut2Geadd9jSwuBV8xRoAnwWsdvktH\",\"type\":\"AgentPassport\"}"
    },
    {
      "name": "ed25519-sign-verify",
      "description": "Ed25519 signature generation and verification.",
      "input": {
        "private_key_hex": "9d61b19deffd5a60ba844af492ec2cc44449c5697b326919703bac031cae7f60",
        "public_key_hex": "d75a980182b10ab7d54bfed3c964073a0ee172f3daa3f4a18446b0b8d183f8e3",
        "message": "{\"type\":\"AgentPassport\"}"
      },
      "expected_output": {
        "signature_hex": "e5564300c360ac729086e2cc806e828a84877f1eb8e5d974d873e065224901555fb8821590a33bacc61e39701cf9b46bd25bf5f0595bbe24655141438e7a100b"
      },
      "notes": "Standard Ed25519 test vector (RFC 8032 Section 7.1 adapted). Implementations should verify round-trip sign+verify."
    },
    {
      "name": "merkle-tree-4-leaves",
      "description": "Merkle tree construction from 4 leaf hashes.",
      "input": {
        "leaves": [
          "0x0000000000000000000000000000000000000000000000000000000000000001",
          "0x0000000000000000000000000000000000000000000000000000000000000002",
          "0x0000000000000000000000000000000000000000000000000000000000000003",
          "0x0000000000000000000000000000000000000000000000000000000000000004"
        ]
      },
      "expected_output": {
        "root": "0x0c48ddc2b8d6d066c52fc608d4d0254f418bea6cd8424fe95390ac87323f9c9f",
        "tree_depth": 2
      },
      "notes": "Nodes are keccak256(sorted_concat(left, right)). Sorted means min(left,right) || max(left,right)."
    },
    {
      "name": "merkle-proof-verification",
      "description": "Verify a Merkle inclusion proof for leaf at index 0.",
      "input": {
        "leaf": "0x0000000000000000000000000000000000000000000000000000000000000001",
        "proof": [
          "0x0000000000000000000000000000000000000000000000000000000000000002",
          "0x2e174c10e159ea99b867ce3205125c24a42d128804e4070ed6fcc8cc98166aa0"
        ],
        "root": "0x0c48ddc2b8d6d066c52fc608d4d0254f418bea6cd8424fe95390ac87323f9c9f"
      },
      "expected_output": {
        "valid": true
      },
      "notes": "Verify by walking up the tree: hash(sorted(leaf, proof[0])), then hash(sorted(result, proof[1])), compare to root."
    },
    {
      "name": "passport-hash-with-benchmarks",
      "description": "Snapshot hash computation including skills, soul, and policies.",
      "input": {
        "skills": {
          "entries": [
            {"name": "go-developer", "version": "1.0.0", "description": "Go backend", "capabilities": ["code_write"], "hash": "0x0000000000000000000000000000000000000000000000000000000000000abc"}
          ],
          "frozen": false
        },
        "soul": {
          "personality": "focused",
          "work_style": "test-first",
          "constraints": [],
          "hash": "0x0000000000000000000000000000000000000000000000000000000000000def",
          "frozen": false
        },
        "policies": {
          "policy_set_hash": "0x0000000000000000000000000000000000000000000000000000000000000123",
          "summary": ["can_bid"]
        }
      },
      "expected_output": "0x9a6dc343c4c0750d93d94e6cba3cbea754a72ee62cf74fa0d10e84c8ee772797",
      "notes": "Canonicalize the input object per RFC 8785, then keccak256. Implementations MUST produce identical hashes."
    },
    {
      "name": "work-receipt-hash-4-events",
      "description": "Receipt hash computation with all 4 lifecycle events.",
      "input": {
        "receipt_id": "550e8400-e29b-41d4-a716-446655440000",
        "job_id": "550e8400-e29b-41d4-a716-446655440001",
        "agent_did": "did:key:z6MkpTHR8VNsBxYAAWHut2Geadd9jSwuBV8xRoAnwWsdvktH",
        "client_did": "did:key:z6MkpOwnerABCDEFGHIJKLMNOPQRSTUVWXYZ12345",
        "agent_snapshot": {"version": 1, "hash": "0x0000000000000000000000000000000000000000000000000000000000000aaa"},
        "events": [
          {"type": "claim", "timestamp": "2026-02-14T01:00:00Z", "payload_hash": "0x0000000000000000000000000000000000000000000000000000000000000001", "signature": "z_claim_sig"},
          {"type": "submit", "timestamp": "2026-02-14T01:30:00Z", "payload_hash": "0x0000000000000000000000000000000000000000000000000000000000000002", "signature": "z_submit_sig"},
          {"type": "verify", "timestamp": "2026-02-14T01:35:00Z", "payload_hash": "0x0000000000000000000000000000000000000000000000000000000000000003", "signature": "z_verify_sig", "result": {"status": "accepted", "score": 87}},
          {"type": "payout", "timestamp": "2026-02-14T01:40:00Z", "payload_hash": "0x0000000000000000000000000000000000000000000000000000000000000004", "signature": "z_payout_sig", "amount": {"value": 500, "unit": "points"}}
        ]
      },
      "expected_output": "0x7d94c67f0a7adaa40afde5441fec924425ec38e3385a37d18817c1898407a781",
      "notes": "Canonicalize the entire receipt object (without proof field), then keccak256."
    },
    {
      "name": "security-envelope-hash",
      "description": "Envelope hash computation.",
      "input": {
        "agent_did": "did:key:z6MkpTHR8VNsBxYAAWHut2Geadd9jSwuBV8xRoAnwWsdvktH",
        "agent_snapshot_hash": "0x0000000000000000000000000000000000000000000000000000000000000aaa",
        "capabilities": {"allowed": ["code_read", "code_write"], "denied": ["network_egress"]},
        "sandbox": {
          "runtime": "gvisor",
          "resources": {"cpu_cores": 1, "memory_mb": 1024, "disk_mb": 2048, "timeout_seconds": 600, "max_pids": 64},
          "network": {"policy": "deny-all", "allowed_egress": [], "dns_resolution": false},
          "filesystem": {"writable_paths": ["/workspace"], "readonly_paths": ["/usr"], "denied_paths": ["/etc/shadow"]}
        },
        "memory": {
          "isolation": "strict",
          "policy": "private-by-design",
          "rules": {"dna_copyable": true, "memory_copyable": false, "context_shared": false, "logs_retained": true, "logs_content_visible": false},
          "vault": {"type": "platform-managed", "encryption": "aes-256-gcm", "key_holder": "agent_owner"}
        },
        "trust": {"tier": 2, "attestation_count": 5, "highest_attestation": "ReliabilityGold", "benchmark_coverage": 0.8, "anomaly_score": 0.02}
      },
      "expected_output": "0x0a44b312b2c6ace579a4fa07b6751a148da81c9ee3f9184706a41250c7ac97d0",
      "notes": "Canonicalize input (without @context, spec_version, type, envelope_hash, proof), then keccak256."
    },
    {
      "name": "anchor-receipt-structure",
      "description": "Validate anchor receipt structure and fields.",
      "input": {
        "tx_hash": "0xc028b7e0fa3ebc1024a08793e3b7fe1de22eb96f026fc3a0f97d4e9b3c5d1a2e",
        "block": 4,
        "timestamp": "2026-02-14T01:45:00Z",
        "provider": "base-sepolia"
      },
      "expected_output": {
        "valid": true,
        "provider_type": "ethereum",
        "has_tx_hash": true,
        "has_block": true
      },
      "notes": "Anchor receipt MUST contain tx_hash, block, timestamp, and provider. Provider 'base-sepolia' implies type 'ethereum'."
    }
  ]
}
